var e=-1,t=t=>{addEventListener(`pageshow`,(n=>{n.persisted&&(e=n.timeStamp,t(n))}),!0)},n=(e,t,n,r)=>{let i,a;return o=>{t.value>=0&&(o||r)&&(a=t.value-(i??0),(a||i===void 0)&&(i=t.value,t.delta=a,t.rating=((e,t)=>e>t[1]?`poor`:e>t[0]?`needs-improvement`:`good`)(t.value,n),e(t)))}},r=e=>{requestAnimationFrame((()=>requestAnimationFrame((()=>e()))))},i=()=>{let e=performance.getEntriesByType(`navigation`)[0];if(e&&e.responseStart>0&&e.responseStart<performance.now())return e},a=()=>i()?.activationStart??0,o=(t,n=-1)=>{let r=i(),o=`navigate`;return e>=0?o=`back-forward-cache`:r&&(document.prerendering||a()>0?o=`prerender`:document.wasDiscarded?o=`restore`:r.type&&(o=r.type.replace(/_/g,`-`))),{name:t,value:n,rating:`good`,delta:0,entries:[],id:`v5-${Date.now()}-${Math.floor(8999999999999*Math.random())+0xe8d4a51000}`,navigationType:o}},s=new WeakMap;function c(e,t){return s.get(e)||s.set(e,new t),s.get(e)}var l=class{t;i=0;o=[];h(e){if(e.hadRecentInput)return;let t=this.o[0],n=this.o.at(-1);this.i&&t&&n&&e.startTime-n.startTime<1e3&&e.startTime-t.startTime<5e3?(this.i+=e.value,this.o.push(e)):(this.i=e.value,this.o=[e]),this.t?.(e)}},u=(e,t,n={})=>{try{if(PerformanceObserver.supportedEntryTypes.includes(e)){let r=new PerformanceObserver((e=>{Promise.resolve().then((()=>{t(e.getEntries())}))}));return r.observe({type:e,buffered:!0,...n}),r}}catch{}},d=e=>{let t=!1;return()=>{t||=(e(),!0)}},f=-1,p=new Set,m=()=>document.visibilityState!==`hidden`||document.prerendering?1/0:0,h=e=>{if(document.visibilityState===`hidden`){if(e.type===`visibilitychange`)for(let e of p)e();isFinite(f)||(f=e.type===`visibilitychange`?e.timeStamp:0,removeEventListener(`prerenderingchange`,h,!0))}},g=()=>{if(f<0){let e=a();f=(document.prerendering?void 0:globalThis.performance.getEntriesByType(`visibility-state`).filter((t=>t.name===`hidden`&&t.startTime>e))[0]?.startTime)??m(),addEventListener(`visibilitychange`,h,!0),addEventListener(`prerenderingchange`,h,!0),t((()=>{setTimeout((()=>{f=m()}))}))}return{get firstHiddenTime(){return f},onHidden(e){p.add(e)}}},_=e=>{document.prerendering?addEventListener(`prerenderingchange`,(()=>e()),!0):e()},v=[1800,3e3],y=(e,i={})=>{_((()=>{let s=g(),c,l=o(`FCP`),d=u(`paint`,(e=>{for(let t of e)t.name===`first-contentful-paint`&&(d.disconnect(),t.startTime<s.firstHiddenTime&&(l.value=Math.max(t.startTime-a(),0),l.entries.push(t),c(!0)))}));d&&(c=n(e,l,v,i.reportAllChanges),t((t=>{l=o(`FCP`),c=n(e,l,v,i.reportAllChanges),r((()=>{l.value=performance.now()-t.timeStamp,c(!0)}))})))}))},b=[.1,.25],x=(e,i={})=>{let a=g();y(d((()=>{let s,d=o(`CLS`,0),f=c(i,l),p=e=>{for(let t of e)f.h(t);f.i>d.value&&(d.value=f.i,d.entries=f.o,s())},m=u(`layout-shift`,p);m&&(s=n(e,d,b,i.reportAllChanges),a.onHidden((()=>{p(m.takeRecords()),s(!0)})),t((()=>{f.i=0,d=o(`CLS`,0),s=n(e,d,b,i.reportAllChanges),r((()=>s()))})),setTimeout(s))})))},S=0,C=1/0,w=0,T=e=>{for(let t of e)t.interactionId&&(C=Math.min(C,t.interactionId),w=Math.max(w,t.interactionId),S=w?(w-C)/7+1:0)},E,D=()=>E?S:performance.interactionCount??0,O=()=>{`interactionCount`in performance||E||(E=u(`event`,T,{type:`event`,buffered:!0,durationThreshold:0}))},k=0,A=class{u=[];l=new Map;m;p;v(){k=D(),this.u.length=0,this.l.clear()}L(){let e=Math.min(this.u.length-1,Math.floor((D()-k)/50));return this.u[e]}h(e){if(this.m?.(e),!e.interactionId&&e.entryType!==`first-input`)return;let t=this.u.at(-1),n=this.l.get(e.interactionId);if(n||this.u.length<10||e.duration>t.P){if(n?e.duration>n.P?(n.entries=[e],n.P=e.duration):e.duration===n.P&&e.startTime===n.entries[0].startTime&&n.entries.push(e):(n={id:e.interactionId,entries:[e],P:e.duration},this.l.set(n.id,n),this.u.push(n)),this.u.sort(((e,t)=>t.P-e.P)),this.u.length>10){let e=this.u.splice(10);for(let t of e)this.l.delete(t.id)}this.p?.(n)}}},j=e=>{let t=globalThis.requestIdleCallback||setTimeout;document.visibilityState===`hidden`?e():(e=d(e),addEventListener(`visibilitychange`,e,{once:!0,capture:!0}),t((()=>{e(),removeEventListener(`visibilitychange`,e,{capture:!0})})))},M=[200,500],N=(e,r={})=>{if(!globalThis.PerformanceEventTiming||!(`interactionId`in PerformanceEventTiming.prototype))return;let i=g();_((()=>{O();let a,s=o(`INP`),l=c(r,A),d=e=>{j((()=>{for(let t of e)l.h(t);let t=l.L();t&&t.P!==s.value&&(s.value=t.P,s.entries=t.entries,a())}))},f=u(`event`,d,{durationThreshold:r.durationThreshold??40});a=n(e,s,M,r.reportAllChanges),f&&(f.observe({type:`first-input`,buffered:!0}),i.onHidden((()=>{d(f.takeRecords()),a(!0)})),t((()=>{l.v(),s=o(`INP`),a=n(e,s,M,r.reportAllChanges)})))}))},P=class{m;h(e){this.m?.(e)}},F=[2500,4e3],I=(e,i={})=>{_((()=>{let s=g(),l,f=o(`LCP`),p=c(i,P),m=e=>{i.reportAllChanges||(e=e.slice(-1));for(let t of e)p.h(t),t.startTime<s.firstHiddenTime&&(f.value=Math.max(t.startTime-a(),0),f.entries=[t],l())},h=u(`largest-contentful-paint`,m);if(h){l=n(e,f,F,i.reportAllChanges);let a=d((()=>{m(h.takeRecords()),h.disconnect(),l(!0)})),s=e=>{e.isTrusted&&(j(a),removeEventListener(e.type,s,{capture:!0}))};for(let e of[`keydown`,`click`,`visibilitychange`])addEventListener(e,s,{capture:!0});t((t=>{f=o(`LCP`),l=n(e,f,F,i.reportAllChanges),r((()=>{f.value=performance.now()-t.timeStamp,l(!0)}))}))}}))},L=[800,1800],R=e=>{document.prerendering?_((()=>R(e))):document.readyState===`complete`?setTimeout(e):addEventListener(`load`,(()=>R(e)),!0)},z=(e,r={})=>{let s=o(`TTFB`),c=n(e,s,L,r.reportAllChanges);R((()=>{let l=i();l&&(s.value=Math.max(l.responseStart-a(),0),s.entries=[l],c(!0),t((()=>{s=o(`TTFB`,0),c=n(e,s,L,r.reportAllChanges),c(!0)})))}))};export{x as onCLS,y as onFCP,N as onINP,I as onLCP,z as onTTFB};